<!doctype html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<title> </title>

<script type="text/javascript" src="js/phaser.min.js"></script>
<script type="text/javascript" src="js/astar.js"></script>
<style type="text/css">
        body {
            margin: 0;
        }
    </style>
</head>
<body>
<script type="text/javascript">

var game = new Phaser.Game(1024, 900, Phaser.AUTO, '', {preload:preload, create:create, update:update});


var ruta = [];
var filas =20;
var columnas = 20;
var alien;
var desierto;

var inicio= {};

inicio.f = 0;
			      inicio.g = 0;
			      inicio.h = 0;
			      inicio.debug = "";
			      inicio.parent = null;

inicio.pos = {};
inicio.pos.x=0;
inicio.pos.y=9;

var fin={};
fin.g = 0;
                              fin.h = 0;
                              fin.debug = "";
                              fin.parent = null;

fin.pos={};
fin.pos.x=19;
fin.pos.y = 10;
var grid =[];
for (var z1 = 0; z1<20;z1++){
grid[z1]=[];

for(var z2 = 0;z2<20;z2++){
grid[z1][z2] = {};

}

}

// A5rojo : matriz con las posiciones de los .pngs del laberinto
var matrizDesierto = 	[7,2,2,2,2,2,4,2,2,0,8,7,8,7,8,7,8,11,2,8,
			 1,11,4,8,14,7,6,8,14,1,10,9,10,9,10,9,1,7,4,9,
			 10,2,9,10,9,3,8,10,9,3,2,2,2,2,8,7,5,1,1,14,
			 7,8,7,8,7,9,10,2,8,10,2,2,2,12,1,1,10,9,1,1,
			 13,10,9,1,1,7,8,7,9,7,4,8,7,8,1,10,8,7,9,1,
			 7,2,2,9,1,1,10,0,4,9,1,13,1,10,9,7,9,1,7,9,
			 1,7,8,7,9,13,7,9,1,7,9,7,9,7,8,10,8,10,9,14,
			 1,1,10,5,7,4,6,12,1,3,2,9,7,9,10,12,1,7,2,5,
			 10,9,7,5,1,1,14,7,9,1,7,2,9,7,2,2,5,1,7,9,
			 11,8,1,10,9,1,10,6,8,1,1,7,8,10,2,8,3,9,1,14,
			 7,5,10,4,4,9,7,2,6,0,6,9,10,2,4,6,5,14,10,9,
			 1,10,4,9,10,2,0,2,8,1,7,12,7,2,9,7,6,6,2,8,
			 1,7,5,7,4,2,9,7,9,1,10,8,3,8,14,10,12,7,2,9,
			 13,1,10,9,1,7,8,1,7,6,2,5,1,1,10,4,8,10,8,14,
			 7,9,7,8,10,9,13,1,10,2,8,13,1,1,7,9,10,12,3,9,
			 10,4,9,10,2,2,8,3,4,2,9,7,9,10,9,7,12,7,6,8,
			 7,9,7,2,2,8,10,5,13,7,2,9,11,2,4,6,2,9,11,9,
			 1,7,6,8,7,6,8,10,2,0,2,8,7,2,5,7,2,2,2,8,
			 10,5,7,9,3,12,10,2,8,13,7,9,13,14,10,9,14,7,8,1,
			 11,9,10,12,10,2,2,12,10,2,0,2,2,6,2,2,6,9,10,9

];
var matrizCactus = [[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
		  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0] ];
function preload(){

// A5rojo : cargo los assets de la gui de la derecha
game.load.image('bordeArriba','assets/arriba.png');
game.load.image('bordeAbajo','assets/abajo.png');
game.load.image('bordeDerecho','assets/bordede.png');
game.load.image('bordeIzquierdo','assets/bordeiz.png');
game.load.image('sinbordes','assets/sinborde.png');
game.load.image('cactusGUI', 'assets/BackupOrig/cactus.png');
game.load.image('cactusI', 'assets/cactusInv.png');

// A5rojo : cargamos los assets de la nave que indica cual es el final o objetivo del juego y el asset de la nave 
// con el piloto que es cuando has perdido
game.load.image('salida', 'assets/nave.png');
game.load.image('fin', 'assets/navePiloto.png');
//game.load.image('nave', 'assets/nave.png');

game.load.spritesheet('alien', 'assets/alien.png',25.5,35,9 );
game.load.spritesheet('desierto', 'assets/desierto.png', 35, 35);

game.load.audio('musica', 'assets/sonidos/ost.m4a');

}

function create(){

// A5rojo : bucle que crea el laberinto 
desierto = game.add.group();
for(var i=0; i<filas;i++)
{
	for(var j = 0;j<columnas;j++)
	{
		var casilla = desierto.create(35+j*35,35+i*35, 'desierto',matrizDesierto[j+i*columnas] );
	}
}

var musica = game.add.audio('musica');
musica.play();



var alien = game.add.sprite(355,35,'alien');

// a5rojo : añado y escalo la gui derecha
for (var i = 0; i < 12; i++)
{
	var derechaGUI21 = game.add.sprite(960,i*64,'bordeDerecho');
	derechaGUI21.scale.setTo(0.5,0.5);

	var derechaGUI41 = game.add.sprite(900,i*64,'sinbordes');
	derechaGUI41.scale.setTo(0.5,0.5);
	var derechaGUI42 = game.add.sprite(840,i*64,'sinbordes');
	derechaGUI42.scale.setTo(0.5,0.5);

	var derechaGUI6 = game.add.sprite(780,i*64,'bordeIzquierdo');
	derechaGUI6.scale.setTo(0.5,0.5);

}


var salida = game.add.sprite(385,710,'salida');
//alien = game.add.sprite(0,0,'alien');
//alien.frame=4;


//alien.animations.add('este', [0,1], 5, true);
//alien.animations.add('oeste', [3,4], 5, true);


// a5rojo : añado y escalo los cactus de la gui que van al lado derecho
var cactusGUI1 = game.add.sprite(930,10,'cactusGUI');
cactusGUI1.scale.setTo(0.5,0.5);

var cactusGUI2 = game.add.sprite(930,100,'cactusGUI');
cactusGUI2.scale.setTo(0.5,0.5);

var cactusGUI3 = game.add.sprite(930,200,'cactusGUI');
cactusGUI3.scale.setTo(0.5,0.5);

ruta = astar.buscar(matrizDesierto, matrizCactus,grid, inicio, fin);


var px=355;
var py=35;
for (var z3=0; z3<ruta.length;z3++){
switch(ruta[z3]){
case 0:
py=py-35;
break;
case 1:
px=px+35;
break;
case 2:
py=py+35;
break;
case 3:
px=px-35;
break;

}
game.add.sprite(px,py,'alien');


}
}

function update(){

//alien.frame = 2;
//alien.animations.play('este');
//desierto.frame = 3;

}

</script>
</body>
</html>
